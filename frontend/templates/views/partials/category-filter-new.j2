{% do doc.styles.addCssFile('css/components/organisms/filter-bubbles-list.css') %}
{% do doc.styles.addCssFile('css/components/atoms/pill.css') %}

<div class="ap-o-filter-bubbles-list">
  <a class="ap-a-pill {% if filter_categories|length == 0 %}filtered{% endif %}" href="{{ doc.url.path }}#filter" name="all">
    {{ _('All') }}
  </a>
  {% for category, components in categories %}
  {% set scope = namespace(categoryFormats = []) %}
    {% for component in components %}
      {% set formats = component.formats or ['websites'] %}
      {% set scope.categoryFormats = scope.categoryFormats + formats %}
    {% endfor %}
  {% if category %}
  {% if format in scope.categoryFormats|unique %}
  {% set category_slug = category.split('.')[1] if category and category.split('.')|length == 2 else category %}
  <a class="ap-a-pill {% if category_slug|slug in filter_categories and category_slug|slug == category_slug|slug %}filtered{% endif %}"
      href="{{ doc.url.path }}?category={{category_slug|slug}}#filter"
      name="{{ _(category_slug) }}">
    {{ _(category_slug) }}
  </a>
  {% endif %}
  {% endif %}
  {% endfor %}
</div>
